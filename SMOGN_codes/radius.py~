import pandas as pd
import smogn

print("Loading data")
#Loading data
df = pd.read_csv('../without_some_cuts-IllustrixTNG300_environment.csv')
df = df.sample(frac = 1, random_state = 42)
df = df.reset_index(drop=True)

print("Pre-processing data")
#Choosing data
total = len(df)
p_train = 3/5
p_test = 2/5

df_1 = df.iloc[:int(p_train*total), :]
df_2 = df.iloc[int(p_train*total):, :]
df_1 = df_1.reset_index(drop=True)
df_2 = df_2.reset_index(drop=True)

rg_mtrx = [
    [0.06, 1, 1],  ## over-sample ("minority")
    [0.32, 0, 1],  ## under-sample ("majority")
    [0.7, 1, 1],  ## over-sample
    [1.0, 1, 1],  ## over-sample
    [2.1, 0, 1],  ## under-sample
]

# #BEST
# rg_mtrx = [
#     [0.06, 1, 1],  ## over-sample ("minority")
#     [0.28, 0, 1],  ## under-sample ("majority")
#     [0.77, 1, 1],  ## over-sample
#     [2.0, 0, 1],  ## under-sample
# ]

print("SMOGing data")
df_s = smogn.smoter(
    ## main arguments
    data = df_1,           ## pandas dataframe
    y = 'radius_g',          ## string ('header name')
    k = 7,                    ## positive integer (k < n)
    pert = 0.04,              ## real number (0 < R < 1)
    samp_method = 'balance',  ## string ('balance' or 'extreme')
    drop_na_col = True,       ## boolean (True or False)
    drop_na_row = True,       ## boolean (True or False)
    replace = False,          ## boolean (True or False)

    ## phi relevance arguments
    rel_thres = 0.3,#0.1,         ## real number (0 < R < 1)
    rel_method = 'manual',    ## string ('auto' or 'manual')
    rel_ctrl_pts_rg = rg_mtrx ## 2d array (format: [x, y])
)

df_s.to_csv('radius-smoogn_data.csv')
